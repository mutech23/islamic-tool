<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Islamic Tools - Prayer Times & Qibla Finder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .compass {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            position: relative;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            background: conic-gradient(
                #f43f5e 0%, #f43f5e 90deg,
                #3b82f6 90deg, #3b82f6 180deg,
                #10b981 180deg, #10b981 270deg,
                #f59e0b 270deg, #f59e0b 360deg
            );
        }
        .compass-inner {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: white;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .compass-needle {
            width: 4px;
            height: 80px;
            background-color: #ef4444;
            position: absolute;
            top: 10px;
            left: 98px;
            transform-origin: bottom center;
            transition: transform 0.5s ease;
            border-radius: 4px;
        }
        .compass-direction {
            position: absolute;
            font-weight: bold;
            color: #1f2937;
        }
        .north { top: 5px; left: 50%; transform: translateX(-50%); }
        .east { top: 50%; right: 5px; transform: translateY(-50%); }
        .south { bottom: 5px; left: 50%; transform: translateX(-50%); }
        .west { top: 50%; left: 5px; transform: translateY(-50%); }

        @media (max-width: 640px) {
            .compass {
                width: 150px;
                height: 150px;
            }
            .compass-inner {
                width: 130px;
                height: 130px;
                top: 10px;
                left: 10px;
            }
            .compass-needle {
                height: 60px;
                top: 5px;
                left: 73px;
            }
        }

        .dark body { background-color: #1f2937; color: white; }
        .dark .bg-white { background-color: #374151; }
        .dark .text-gray-800, .dark .text-gray-600, .dark .text-gray-700 { color: #e5e7eb; }
        .dark .border-gray-200 { border-color: #4b5563; }
        .dark .bg-gray-100 { background-color: #4b5563; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen font-sans">
    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-10">
            <h1 class="text-4xl font-bold text-indigo-800 mb-2">Islamic Tools</h1>
            <p class="text-gray-600">Prayer Times & Qibla Finder</p>
            <div class="w-24 h-1 bg-indigo-500 mx-auto mt-4 rounded-full"></div>
            <div class="mt-4">
                <button id="toggle-dark" class="bg-indigo-500 text-white px-4 py-1 rounded-md hover:bg-indigo-600 transition">
                    Toggle Dark Mode
                </button>
            </div>
        </header>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Islamic Tools - Prayer Times & Qibla Finder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .compass {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            position: relative;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            background: conic-gradient(
                #f43f5e 0%, #f43f5e 90deg, 
                #3b82f6 90deg, #3b82f6 180deg, 
                #10b981 180deg, #10b981 270deg, 
                #f59e0b 270deg, #f59e0b 360deg
            );
        }
        .compass-inner {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: white;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .compass-needle {
            width: 4px;
            height: 80px;
            background-color: #ef4444;
            position: absolute;
            top: 10px;
            left: 98px;
            transform-origin: bottom center;
            transition: transform 0.5s ease;
            border-radius: 4px;
        }
        .compass-direction {
            position: absolute;
            font-weight: bold;
            color: #1f2937;
        }
        .north { top: 5px; left: 50%; transform: translateX(-50%); }
        .east { top: 50%; right: 5px; transform: translateY(-50%); }
        .south { bottom: 5px; left: 50%; transform: translateX(-50%); }
        .west { top: 50%; left: 5px; transform: translateY(-50%); }
        
        .prayer-card {
            transition: all 0.3s ease;
        }
        .prayer-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
        }
        .current-prayer {
            border: 2px solid #3b82f6;
            background-color: #eff6ff;
        }
        
        @media (max-width: 640px) {
            .compass {
                width: 150px;
                height: 150px;
            }
            .compass-inner {
                width: 130px;
                height: 130px;
                top: 10px;
                left: 10px;
            }
            .compass-needle {
                height: 60px;
                top: 5px;
                left: 73px;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen font-sans">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <header class="text-center mb-10">
            <h1 class="text-4xl font-bold text-indigo-800 mb-2">Islamic Tools</h1>
            <p class="text-gray-600">Prayer Times & Qibla Finder</p>
            <div class="w-24 h-1 bg-indigo-500 mx-auto mt-4 rounded-full"></div>
        </header>

        <!-- Main Content -->
        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Prayer Times Section -->
            <div class="lg:w-2/3">
                <div class="bg-white rounded-xl shadow-md p-6 mb-8">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-semibold text-gray-800">Prayer Times</h2>
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-map-marker-alt text-indigo-600"></i>
                            <span id="location" class="font-medium">Loading location...</span>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-6">
                        <div class="flex items-center">
                            <select id="calculation-method" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                                <option value="0">Muslim World League</option>
                                <option value="1">Islamic Society of North America</option>
                                <option value="2">Egyptian General Authority</option>
                                <option value="3">Umm Al-Qura University, Makkah</option>
                                <option value="4">University of Islamic Sciences, Karachi</option>
                                <option value="5">Institute of Geophysics, University of Tehran</option>
                                <option value="7">Gulf Region</option>
                                <option value="8">Kuwait</option>
                                <option value="9">Qatar</option>
                                <option value="10">Majlis Ugama Islam Singapura</option>
                                <option value="11">Union Organization Islamic de France</option>
                                <option value="12">Diyanet İşleri Başkanlığı, Turkey</option>
                                <option value="13">Spiritual Administration of Muslims of Russia</option>
                            </select>
                        </div>
                        <div class="flex items-center">
                            <select id="asr-method" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                                <option value="0">Shafi'i, Maliki, Hanbali (Standard)</option>
                                <option value="1">Hanafi</option>
                            </select>
                        </div>
                        <div class="flex items-center">
                            <input type="date" id="date-selector" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                        <!-- Prayer cards will be inserted here by JavaScript -->
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-6">Islamic Calendar</h2>
                    <div class="flex justify-between items-center mb-4">
                        <button id="prev-month" class="p-2 rounded-full hover:bg-gray-100">
                            <i class="fas fa-chevron-left text-indigo-600"></i>
                        </button>
                        <h3 id="current-month" class="text-xl font-medium text-gray-700">Month, Year</h3>
                        <button id="next-month" class="p-2 rounded-full hover:bg-gray-100">
                            <i class="fas fa-chevron-right text-indigo-600"></i>
                        </button>
                    </div>
                    <div class="grid grid-cols-7 gap-2 text-center">
                        <div class="font-medium text-gray-500 py-2">Sun</div>
                        <div class="font-medium text-gray-500 py-2">Mon</div>
                        <div class="font-medium text-gray-500 py-2">Tue</div>
                        <div class="font-medium text-gray-500 py-2">Wed</div>
                        <div class="font-medium text-gray-500 py-2">Thu</div>
                        <div class="font-medium text-gray-500 py-2">Fri</div>
                        <div class="font-medium text-gray-500 py-2">Sat</div>
                        <!-- Calendar days will be inserted here by JavaScript -->
                    </div>
                </div>
            </div>
            
            <!-- Qibla Finder Section -->
            <div class="lg:w-1/3">
                <div class="bg-white rounded-xl shadow-md p-6 sticky top-4">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-6">Qibla Finder</h2>
                    
                    <div class="flex justify-center mb-8">
                        <div class="compass">
                            <div class="compass-inner">
                                <div class="compass-needle" id="compass-needle"></div>
                                <div class="compass-direction north">N</div>
                                <div class="compass-direction east">E</div>
                                <div class="compass-direction south">S</div>
                                <div class="compass-direction west">W</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="flex items-center">
                            <i class="fas fa-info-circle text-indigo-600 mr-2"></i>
                            <span id="qibla-direction" class="text-gray-700">Point your device towards Kaaba</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-compass text-indigo-600 mr-2"></i>
                            <span id="compass-status" class="text-gray-700">Waiting for compass permission...</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-location-arrow text-indigo-600 mr-2"></i>
                            <span id="qibla-angle" class="text-gray-700">Calculating Qibla direction...</span>
                        </div>
                    </div>
                    
                    <div class="mt-8">
                        <h3 class="text-lg font-medium text-gray-700 mb-3">Find Qibla by Location</h3>
                        <div class="flex mb-4">
                            <input type="text" id="qibla-location" placeholder="Enter city name" class="flex-grow p-2 border border-gray-300 rounded-l-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                            <button id="find-qibla" class="bg-indigo-600 text-white px-4 py-2 rounded-r-md hover:bg-indigo-700 transition">Find</button>
                        </div>
                        <div id="qibla-map" class="h-48 bg-gray-200 rounded-md flex items-center justify-center">
                            <p class="text-gray-500">Map will appear here</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <footer class="mt-12 text-center text-gray-600 py-6 border-t border-gray-200">
            <p>© 2025 Islamic Tools. All rights reserved.</p>
            <div class="flex justify-center space-x-4 mt-4">
                <a href="#" class="hover:text-indigo-600"><i class="fab fa-facebook"></i></a>
                <a href="#" class="hover:text-indigo-600"><i class="fab fa-twitter"></i></a>
                <a href="#" class="hover:text-indigo-600"><i class="fab fa-instagram"></i></a>
            </div>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize variables
            let currentDate = new Date();
            let userLocation = null;
            let qiblaDirection = 0;
            let currentHeading = 0;
            
            // DOM Elements
            const locationElement = document.getElementById('location');
            const prayerTimesContainer = document.querySelector('.grid.grid-cols-2');
            const qiblaDirectionElement = document.getElementById('qibla-direction');
            const compassNeedle = document.getElementById('compass-needle');
            const compassStatus = document.getElementById('compass-status');
            const qiblaAngleElement = document.getElementById('qibla-angle');
            const currentMonthElement = document.getElementById('current-month');
            const calendarDaysContainer = document.querySelector('.grid.grid-cols-7');
            const dateSelector = document.getElementById('date-selector');
            const calculationMethod = document.getElementById('calculation-method');
            const asrMethod = document.getElementById('asr-method');
            const qiblaLocationInput = document.getElementById('qibla-location');
            const findQiblaButton = document.getElementById('find-qibla');
            const prevMonthButton = document.getElementById('prev-month');
            const nextMonthButton = document.getElementById('next-month');
            
            // Set today's date in date picker
            dateSelector.valueAsDate = currentDate;
            
            // Initialize calendar
            updateCalendar(currentDate.getFullYear(), currentDate.getMonth());
            
            // Event Listeners
            dateSelector.addEventListener('change', updatePrayerTimes);
            calculationMethod.addEventListener('change', updatePrayerTimes);
            asrMethod.addEventListener('change', updatePrayerTimes);
            prevMonthButton.addEventListener('click', goToPreviousMonth);
            nextMonthButton.addEventListener('click', goToNextMonth);
            findQiblaButton.addEventListener('click', findQiblaByLocation);
            
            // Get user's location
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    position => {
                        userLocation = {
                            latitude: position.coords.latitude,
                            longitude: position.coords.longitude
                        };
                        locationElement.textContent = `Lat: ${userLocation.latitude.toFixed(4)}, Long: ${userLocation.longitude.toFixed(4)}`;
                        updatePrayerTimes();
                        calculateQiblaDirection();
                        setupCompass();
                    },
                    error => {
                        console.error("Error getting location:", error);
                        locationElement.textContent = "Location access denied. Using default location.";
                        // Default to Mecca's coordinates if location access is denied
                        userLocation = {
                            latitude: 21.3891,
                            longitude: 39.8579
                        };
                        updatePrayerTimes();
                        calculateQiblaDirection();
                    }
                );
            } else {
                locationElement.textContent = "Geolocation not supported by browser.";
                // Default to Mecca's coordinates if geolocation is not supported
                userLocation = {
                    latitude: 21.3891,
                    longitude: 39.8579
                };
                updatePrayerTimes();
                calculateQiblaDirection();
            }
            
            // Functions
            function updatePrayerTimes() {
                if (!userLocation) return;
                
                const selectedDate = dateSelector.valueAsDate || currentDate;
                const method = calculationMethod.value;
                const asrJuristic = asrMethod.value;
                
                // In a real app, you would call an API like Aladhan API here
                // For this demo, we'll use mock data
                const mockPrayerTimes = {
                    Fajr: "05:30",
                    Sunrise: "06:45",
                    Dhuhr: "12:30",
                    Asr: "15:45",
                    Maghrib: "18:20",
                    Isha: "19:45"
                };
                
                // Clear previous prayer times
                prayerTimesContainer.innerHTML = '';
                
                // Create prayer cards
                for (const [prayerName, prayerTime] of Object.entries(mockPrayerTimes)) {
                    const prayerCard = document.createElement('div');
                    prayerCard.className = `prayer-card bg-white border border-gray-200 rounded-lg p-4 flex flex-col items-center justify-center ${prayerName === 'Dhuhr' ? 'current-prayer' : ''}`;
                    
                    const prayerIcon = document.createElement('i');
                    let iconClass = '';
                    switch(prayerName) {
                        case 'Fajr': iconClass = 'fas fa-moon text-indigo-500'; break;
                        case 'Sunrise': iconClass = 'fas fa-sun text-yellow-500'; break;
                        case 'Dhuhr': iconClass = 'fas fa-sun text-orange-500'; break;
                        case 'Asr': iconClass = 'fas fa-cloud-sun text-blue-500'; break;
                        case 'Maghrib': iconClass = 'fas fa-sunset text-red-500'; break;
                        case 'Isha': iconClass = 'fas fa-moon text-indigo-800'; break;
                    }
                    prayerIcon.className = `${iconClass} text-2xl mb-2`;
                    
                    const prayerNameElement = document.createElement('h3');
                    prayerNameElement.className = 'font-semibold text-gray-800';
                    prayerNameElement.textContent = prayerName;
                    
                    const prayerTimeElement = document.createElement('p');
                    prayerTimeElement.className = 'text-xl font-bold text-indigo-600';
                    prayerTimeElement.textContent = prayerTime;
                    
                    prayerCard.appendChild(prayerIcon);
                    prayerCard.appendChild(prayerNameElement);
                    prayerCard.appendChild(prayerTimeElement);
                    
                    prayerTimesContainer.appendChild(prayerCard);
                }
            }
            
            function calculateQiblaDirection() {
                if (!userLocation) return;
                
                // Coordinates of the Kaaba in Mecca
                const kaabaLat = 21.3891;
                const kaabaLong = 39.8579;
                
                // Convert degrees to radians
                const phi1 = userLocation.latitude * Math.PI / 180;
                const phi2 = kaabaLat * Math.PI / 180;
                const deltaLambda = (kaabaLong - userLocation.longitude) * Math.PI / 180;
                
                // Calculate the bearing
                const y = Math.sin(deltaLambda) * Math.cos(phi2);
                const x = Math.cos(phi1) * Math.sin(phi2) - Math.sin(phi1) * Math.cos(phi2) * Math.cos(deltaLambda);
                qiblaDirection = Math.atan2(y, x) * 180 / Math.PI;
                
                // Normalize to 0-360
                qiblaDirection = (qiblaDirection + 360) % 360;
                
                qiblaDirectionElement.textContent = `Qibla direction: ${Math.round(qiblaDirection)}° from North`;
                qiblaAngleElement.textContent = `Angle to Kaaba: ${Math.round(qiblaDirection)} degrees`;
                
                // Update compass needle if we have heading
                updateCompass();
            }
            
            function setupCompass() {
                if (window.DeviceOrientationEvent) {
                    window.addEventListener('deviceorientation', function(event) {
                        if (event.webkitCompassHeading !== undefined) {
                            // For iOS
                            currentHeading = event.webkitCompassHeading;
                            compassStatus.textContent = "Compass active. Point your device towards Kaaba.";
                        } else if (event.absolute && event.alpha !== null) {
                            // For Android and other devices
                            currentHeading = event.alpha;
                            compassStatus.textContent = "Compass active. Point your device towards Kaaba.";
                        }
                        updateCompass();
                    }, true);
                } else {
                    compassStatus.textContent = "Compass not supported on this device.";
                }
            }
            
            function updateCompass() {
                if (currentHeading !== null && qiblaDirection !== null) {
                    // Calculate the angle between current heading and qibla direction
                    const angle = (360 - currentHeading + qiblaDirection) % 360;
                    compassNeedle.style.transform = `rotate(${angle}deg)`;
                }
            }
            
            function findQiblaByLocation() {
                const location = qiblaLocationInput.value.trim();
                if (!location) return;
                
                // In a real app, you would use a geocoding API here
                // For this demo, we'll use mock coordinates for a few cities
                const mockLocations = {
                    "new york": { lat: 40.7128, long: -74.0060 },
                    "london": { lat: 51.5074, long: -0.1278 },
                    "dubai": { lat: 25.2048, long: 55.2708 },
                    "jakarta": { lat: -6.2088, long: 106.8456 },
                    "mecca": { lat: 21.3891, long: 39.8579 }
                };
                
                const normalizedLocation = location.toLowerCase();
                if (mockLocations[normalizedLocation]) {
                    userLocation = mockLocations[normalizedLocation];
                    locationElement.textContent = `Location: ${location.charAt(0).toUpperCase() + location.slice(1)}`;
                    calculateQiblaDirection();
                    updatePrayerTimes();
                } else {
                    alert("Location not found in our demo database. Try: New York, London, Dubai, Jakarta, or Mecca.");
                }
            }
            
            function updateCalendar(year, month) {
                currentMonthElement.textContent = new Date(year, month).toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
                
                // Clear previous calendar days
                while (calendarDaysContainer.children.length > 7) {
                    calendarDaysContainer.removeChild(calendarDaysContainer.lastChild);
                }
                
                // Get first day of month and total days in month
                const firstDay = new Date(year, month, 1).getDay();
                const daysInMonth = new Date(year, month + 1, 0).getDate();
                
                // Add empty cells for days before the first day of the month
                for (let i = 0; i < firstDay; i++) {
                    const emptyDay = document.createElement('div');
                    emptyDay.className = 'py-2';
                    calendarDaysContainer.appendChild(emptyDay);
                }
                
                // Add days of the month
                for (let day = 1; day <= daysInMonth; day++) {
                    const dayElement = document.createElement('div');
                    dayElement.className = 'py-2 border border-gray-200 hover:bg-indigo-50 cursor-pointer';
                    
                    // Highlight current day
                    if (day === currentDate.getDate() && month === currentDate.getMonth() && year === currentDate.getFullYear()) {
                        dayElement.classList.add('bg-indigo-100', 'font-semibold');
                    }
                    
                    dayElement.textContent = day;
                    calendarDaysContainer.appendChild(dayElement);
                }
            }
            
            function goToPreviousMonth() {
                currentDate = new Date(currentDate.getFullYear(), currentDate.getMonth() - 1, 1);
                updateCalendar(currentDate.getFullYear(), currentDate.getMonth());
            }
            
            function goToNextMonth() {
                currentDate = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 1);
                updateCalendar(currentDate.getFullYear(), currentDate.getMonth());
            }
            
            // Initial setup
            updatePrayerTimes();
        });
    </script>
</body>
</html>

    </div>

    <script>
        document.getElementById('toggle-dark').addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
        });
    </script>
</body>
</html>
